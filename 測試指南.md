# AutoRun 排程器測試指南

## 修正內容

### 1. 排程器執行邏輯修正
- ? 修正時間比對邏輯（TimeSpan.Hours 和 TimeSpan.Minutes）
- ? 加入調試日誌功能，追蹤排程器運作狀態
- ? 改善錯誤處理，不再吞掉例外訊息

### 2. 應用程式設定說明

**重要澄清**：
- **"最小化自動啟動排程"**：當視窗最小化到系統托盤時，自動啟動排程器
- **"開機自動啟動"**：Windows 開機時自動啟動此應用程式
- **"啟動排程器"按鈕**：手動控制排程器的啟動/停止

這三個功能是獨立的，互不影響。

## 測試步驟

### 測試 1：基本排程功能

1. **設定一個測試排程**：
   - 點擊「新增」
   - 名稱：測試排程
   - 程式：選擇任何可執行檔（例如：notepad.exe）
   - 時間：設定為當前時間 + 2 分鐘
   - 星期：勾選今天的星期
   - 確認「啟用」已勾選
   - 點擊「加入/更新」

2. **啟動排程器**：
   - 點擊「啟動排程器」按鈕
   - 檢查「執行紀錄」應該顯示：
     ```
     [時間] 排程器已啟動，檢查間隔: 5秒
     [時間] 已載入 1 個排程項目
     ```

3. **等待執行**：
   - 等待到設定的時間
   - 程式應該會自動執行
   - 檢查「執行紀錄」應該顯示：
     ```
     [時間] 已啟動: 測試排程 -> notepad.exe
     ```

### 測試 2：最小化自動啟動排程

1. **停止排程器**：
   - 點擊「停止排程」按鈕
   - 確認按鈕文字變為「啟動排程器」

2. **測試最小化功能**：
   - 勾選「最小化自動啟動排程」
   - 最小化視窗
   - 應該會看到托盤圖示和提示「排程器執行中」

3. **恢復視窗檢查**：
   - 雙擊托盤圖示恢復視窗
   - 檢查「執行紀錄」應該有：
     ```
     [時間] 最小化到托盤 - 自動啟動排程器
     ```
   - 按鈕文字應該顯示「停止排程」

### 測試 3：開機自動啟動

1. **啟用開機啟動**：
   - 勾選「開機自動啟動」
   - 檢查 Windows 註冊表是否已設定（可選）

2. **驗證**：
   - 重新啟動電腦
   - 應用程式應該會自動啟動
   - 但排程器**不會**自動啟動（需要手動點擊或最小化觸發）

### 測試 4：從托盤控制排程器

1. **最小化到托盤**：
   - 最小化視窗到托盤

2. **從托盤控制**：
   - 右鍵點擊托盤圖示
   - 選擇「停止排程器」或「啟動排程器」
   - 檢查功能是否正常

3. **恢復視窗驗證**：
   - 雙擊托盤圖示恢復視窗
   - 確認按鈕文字與實際狀態一致

## 調試技巧

### 查看執行紀錄
「執行紀錄」會顯示所有重要事件：
- 排程器啟動/停止
- 排程項目載入
- 排程執行成功/失敗
- 錯誤訊息

### 常見問題排查

**問題：排程沒有執行**
- ? 檢查排程器是否已啟動（按鈕顯示「停止排程」）
- ? 檢查「啟用」選項是否勾選
- ? 檢查星期選擇是否包含今天
- ? 檢查時間格式（24小時制）
- ? 檢查程式路徑是否正確

**問題：最小化沒有自動啟動排程**
- ? 確認「最小化自動啟動排程」已勾選
- ? 檢查執行紀錄是否有相關訊息
- ? 確認視窗是最小化（不是關閉）

**問題：時間到了但沒執行**
- ? 排程器每 5 秒檢查一次，可能會有幾秒延遲
- ? 同一分鐘內只會執行一次（防止重複執行）
- ? 檢查系統時間是否正確

## 時間格式說明

- 使用 24 小時制
- 例如：09:00 = 上午 9 點
- 例如：21:00 = 晚上 9 點
- 排程器會在該時間的任何一秒內觸發（例如 09:00:00 到 09:00:59）

## 建議的測試排程

為了快速測試，建議使用以下設定：
- **程式**：C:\Windows\System32\notepad.exe（記事本）
- **參數**：（留空）
- **時間**：當前時間 + 1 或 2 分鐘
- **星期**：選擇今天
- **啟用**：勾選

這樣可以在短時間內看到結果，確認功能正常運作。
